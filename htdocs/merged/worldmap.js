var Worldmap={Data:{t:0},init:function(e){Worldmap.Data.t=e,$("#worldmap").draggable({stop:Worldmap.savePosition,containment:[0,60]})},toggle:function(){switch("undefined"==typeof toggle_value||0==toggle_value?("undefined"==typeof toggle_value&&Worldmap.reload(),toggle_value=!0):toggle_value=!1,toggle_value){case!0:$("#worldmap").show();break;case!1:$("#worldmap").hide()}},reload:function(){var e="&cut=true";$("#worldmap_settings").children(":checked").each(function(){switch($(this).attr("name")){case"worldmap_barbarian_toggle":e+="&barbarian=true";break;case"worldmap_ally_toggle":e+="&ally=true";break;case"worldmap_partner_toggle":e+="&partner=true";break;case"worldmap_nap_toggle":e+="&nap=true";break;case"worldmap_enemy_toggle":e+="&enemy=true"}}),Worldmap.Data.t>0&&(e=e+"&t="+Worldmap.Data.t),Worldmap.loadMapImage(e)},loadMapImage:function(e){$("#worldmap_body").hide(),$("#worldmap-throbber").show();var t=new Image;t.onload=function(){$("#worldmap-throbber").hide(),$("#secrets").css("left",(this.width-1e3)/2).css("top",(this.height-1e3)/2);var e=500-this.width/2,t=500-this.height/2;$("#worldmap_image > input").width(this.width).height(this.height).click(function(a){var o=$(this).offset(),r=a.offsetX?a.offsetX:a.pageX-this.offsetLeft-o.left,l=a.offsetY?a.offsetY:a.pageY-this.offsetTop-o.top;return r+=e,l+=t,Worldmap.toggle(),TWMap.map.centerPos(r,l),!1}),$("#worldmap_body").width(this.width).height(this.height).css("background-image","url("+this.src+")").show()},t.src="page.php?page=worldmap_image"+e},savePosition:function(e,t){$.cookie("worldmap_left",$(this).css("left")),$.cookie("worldmap_top",$(this).css("top"))}};