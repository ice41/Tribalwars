<?phpif ($_GET['action'] === 'change_passwd' and count($_POST) > 0) {	if ($_GET['h'] == $session['hkey']) {		//Po³¹czyæ z centraln¹ baz¹ danych:		cdb_central();				//Wbierz has³o		$tw_user_pass = sql("SELECT `haslo` FROM `gracze` WHERE `id` = '".$user['tw_id']."'",'array');				//Zakoduj stare has³o		$_POST['old_passwd'] = md5($_POST['old_passwd']);				if ($tw_user_pass === $_POST['old_passwd']) {			if ($_POST['new_passwd'] === $_POST['new_passwd_rpt']) {				if (strlen($_POST['new_passwd']) < 4) {					$error = 'Nowe has³o musi sk³adaæ siê co najmniej z 4 znaków.';					} else {					$_POST['new_passwd'] = md5($_POST['new_passwd']);					mysql_query("UPDATE `gracze` SET `haslo` = '".$_POST['new_passwd']."' WHERE `id` = '".$user['tw_id']."'");					header('location: game.php?village='.$village['id'].'&screen=settings&mode=change_passwd');					exit;					}				} else {				$error = 'Nowe has³o musi byæ identyczne z polem powtórz.';				}			} else {			$error = 'WprowadŸ poprawne has³o.';			}				//Z powrotem po³¹cz z baz¹ tego serwera		cdb_server();		} else {		$error = 'B³¹d wykonywania akcji.';		}	}	$tpl->assign('error',$error);?>